<!--
  ~ Copyright (c) 2004-2022 The MZmine Development Team
  ~
  ~ Permission is hereby granted, free of charge, to any person
  ~ obtaining a copy of this software and associated documentation
  ~ files (the "Software"), to deal in the Software without
  ~ restriction, including without limitation the rights to use,
  ~ copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the
  ~ Software is furnished to do so, subject to the following
  ~ conditions:
  ~
  ~ The above copyright notice and this permission notice shall be
  ~ included in all copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  ~ EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  ~ OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  ~ NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
  ~ HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
  ~ WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  ~ FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
  ~ OTHER DEALINGS IN THE SOFTWARE.
  -->

<html>
        <head>
                <title>Data analysis - Heat map plot</title>
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                <link rel="stylesheet" type="text/css" href="/net/sf/mzmine/desktop/impl/helpsystem/HelpStyles.css">
        </head>

        <body>

                <h1>Heat map plot</h1>

                <h2>Description</h2>
                <p>
                        A heat map is a graphical representation of data where the values taken by a variable in a two-dimensional
                        table are represented as colors.
                        It is a false color image with a dendrogram added to the left side and to the top.
                        Reordering of the rows and columns according to some set of values (row or column means)
                        within the restrictions imposed by the dendrogram is carried out.

                        <br> <br>

                        This module is using the R function "heatmap.2" to draw the heat map plot.                         
                        The function description can be found here:

                        <br>
                        <a href="http://hosho.ees.hokudai.ac.jp/~kubo/Rdoc/library/gplots/html/heatmap.2.html">http://hosho.ees.hokudai.ac.jp/~kubo/Rdoc/library/gplots/html/heatmap.2.html </a>
                </p>
                <br>
                <p>
                        <img src="heatmap.png" name="Heat map plot">
                        <img src="heatmapgrouping.png" name="Heat map plot using p-value legend">
                </p>

                <h4>Method parameters</h4>
                <dl>
                        <dt>Output name</dt>
                        <dd>Path of the heat map plot output file.</dd>

                        <dt>Output file type</dt>
                        <dd>The output file can be "pdf", "svg", "png" or "fig". The height and width of the plot depend on the type of file.
                                In the case of "png" type, the height and width have to be more than 500. </dd>

                        <dt>Sample parameter</dt>
                        <dd>Description of the samples defined by the user in "Project-> Set sample parameters" section. There has to be at
                                least two groups. One of the groups will be used as a reference group and the rest of the groups will be compared to it.</dd>

                        <dt>Group of reference</dt>
                        <dd>Name of the group used as a reference by the heat map plot. The rest of the groups defined in the sample parameters
                                will be compared to it </dd>

                        <dt>Only identified rows</dt>
                        <dd>Only identified rows will be plotted.</dd>

                        <dt>Use peak area</dt>
                        <dd>If it is selected the peak area will be used to create the heat map plot. If it is not selected peak height will be used.</dd>

                        <dt>Scaling</dt>
                        <dd>The data will be scaled using the standard deviation of the values of all the rows in each sample.</dd>

                        <dt>Log</dt>
                        <dd>Log transformation of the data.</dd>

                        <dt>Show control samples</dt>
                        <dd>The samples in the reference group will be shown if this option is selected. It is only valid when P-value legend is not
                                selected and the individual samples are plotted.</dd>

                        <dt>P-value legend</dt>
                        <dd>If this option is selected the mean of each group will be compared with the mean of the reference group using T-test.
                                The plot will show the groups instead the individual samples and the significance (depending on the p-value) of their mean differences.
                                If the p-value is less than 0.001, "***" will be printed into the corresponding cell. If the p-value is between than 0.01 and 0.001,
                                "**" will be printed, and if it is between 0.05 and 0.01, "*" will be printed into the corresponding cell. </dd>

                        <dt>Size p-value legend</dt>
                        <dd>Size of the "*" in the heat map plot.</dd>

                        <dt>Height</dt>
                        <dd>Height of the heat map plot.</dd>

                        <dt>Width</dt>
                        <dd>Width of the heat map plot.</dd>

                        <dt>Column margin</dt>
                        <dd>Column margin of the heat map plot.</dd>

                        <dt>Row margin</dt>
                        <dd>Row margin of the heat map plot.</dd>


                </dl>

        </body>
</html>
